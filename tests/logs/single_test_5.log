[0;34mRunning single test file...[0m
============================= test session starts ==============================
platform darwin -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /opt/miniconda3/envs/PyQt/bin/python
cachedir: .pytest_cache
PyQt6 6.4.2 -- Qt runtime 6.4.3 -- Qt compiled 6.4.2
benchmark: 5.1.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: /Users/lpcw/Documents/PyQt/PyExcelApp
configfile: pytest.ini
plugins: qt-4.4.0, cov-6.0.0, benchmark-5.1.0, anyio-4.6.2, xdist-3.6.1, asyncio-0.25.1
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None
collecting ... collected 13 items

tests/unit/monitoring/test_dependency_monitoring.py::TestVersionMonitoring::test_version_check[version_data0-up_to_date] PASSED [  7%]
tests/unit/monitoring/test_dependency_monitoring.py::TestVersionMonitoring::test_version_check[version_data1-outdated] PASSED [ 15%]
tests/unit/monitoring/test_dependency_monitoring.py::TestVersionMonitoring::test_version_check[version_data2-error] PASSED [ 23%]
tests/unit/monitoring/test_dependency_monitoring.py::TestSecurityMonitoring::test_security_scan[vulnerability_data0] PASSED [ 30%]
tests/unit/monitoring/test_dependency_monitoring.py::TestSecurityMonitoring::test_security_scan[vulnerability_data1] PASSED [ 38%]
tests/unit/monitoring/test_dependency_monitoring.py::TestSecurityMonitoring::test_security_scan[vulnerability_data2] PASSED [ 46%]
tests/unit/monitoring/test_dependency_monitoring.py::TestCompatibilityChecking::test_compatibility_check[compatibility_data0-True] PASSED [ 53%]
tests/unit/monitoring/test_dependency_monitoring.py::TestCompatibilityChecking::test_compatibility_check[compatibility_data1-False] PASSED [ 61%]
tests/unit/monitoring/test_dependency_monitoring.py::TestCompatibilityChecking::test_compatibility_check[compatibility_data2-None] PASSED [ 69%]
tests/unit/monitoring/test_dependency_monitoring.py::TestNotificationChannels::test_email_notification PASSED [ 76%]
tests/unit/monitoring/test_dependency_monitoring.py::TestNotificationChannels::test_slack_notification PASSED [ 84%]
tests/unit/monitoring/test_dependency_monitoring.py::TestIntegratedMonitoring::test_monitoring_workflow PASSED [ 92%]
tests/unit/monitoring/test_dependency_monitoring.py::TestIntegratedMonitoring::test_async_monitoring FAILED [100%]

=================================== FAILURES ===================================
________________ TestIntegratedMonitoring.test_async_monitoring ________________

self = <test_dependency_monitoring.TestIntegratedMonitoring object at 0x14fc66d50>
event_bus = <src.core.event_bus.EventBus object at 0x14fcd5690>

    @pytest.mark.asyncio
    async def test_async_monitoring(self, event_bus):
        """æµ‹è¯•å¼‚æ­¥ç›‘æŽ§åŠŸèƒ½"""
        mock_response = MagicMock()
        mock_response.status = 200
        mock_response.json = MagicMock(return_value={"status": "up_to_date"})
    
        mock_session = MagicMock()
        mock_session.__aenter__.return_value = mock_response
    
        mock_client = MagicMock()
        mock_client.get.return_value = mock_session
    
        with patch('aiohttp.ClientSession', return_value=mock_client):
            checker = VersionChecker(event_bus)
            result = await checker.check_async()
>           assert result['status'] == 'up_to_date'
E           AssertionError: assert 'error' == 'up_to_date'
E             
E             - up_to_date
E             + error

tests/unit/monitoring/test_dependency_monitoring.py:175: AssertionError
=============================== warnings summary ===============================
tests/unit/monitoring/test_dependency_monitoring.py::TestIntegratedMonitoring::test_async_monitoring
  /Users/lpcw/Documents/PyQt/PyExcelApp/dependency_monitoring_framework/src/services/version_checker.py:46: RuntimeWarning: coroutine 'AsyncMockMixin._execute_mock_call' was never awaited
    async with session.get(f"{self.base_url}/versions", timeout=self.timeout) as response:
  Enable tracemalloc to get traceback where the object was allocated.
  See https://docs.pytest.org/en/stable/how-to/capture-warnings.html#resource-warnings for more info.

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/unit/monitoring/test_dependency_monitoring.py::TestIntegratedMonitoring::test_async_monitoring - AssertionError: assert 'error' == 'up_to_date'
  
  - up_to_date
  + error
=================== 1 failed, 12 passed, 1 warning in 0.22s ====================
